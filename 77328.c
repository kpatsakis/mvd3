static pvscsi_on_cmd_adapter_reset(PVSCSIState *s) pvscsi_reset_adapter ( s ); static pvscsi_reset_adapter(PVSCSIState *s) s -> resetting ++; s -> resetting --; pvscsi_reset_state ( s ); static pvscsi_reset_state(PVSCSIState *s) s -> curr_cmd = PVSCSI_CMD_FIRST; s -> curr_cmd_data_cntr = 0; s -> reg_command_status = PVSCSI_COMMAND_PROCESSING_SUCCEEDED; s -> reg_interrupt_status = 0; pvscsi_ring_cleanup ( & s -> rings ); static pvscsi_ring_cleanup(PVSCSIRingInfo *mgr) mgr -> rs_pa = 0; mgr -> txr_len_mask = 0; mgr -> rxr_len_mask = 0; mgr -> msg_len_mask = 0; mgr -> consumed_ptr = 0; mgr -> filled_cmp_ptr = 0; mgr -> filled_msg_ptr = 0; memset ( mgr -> req_ring_pages_pa , 0 , sizeof ( mgr -> req_ring_pages_pa ) ); memset ( mgr -> cmp_ring_pages_pa , 0 , sizeof ( mgr -> cmp_ring_pages_pa ) ); memset ( mgr -> msg_ring_pages_pa , 0 , sizeof ( mgr -> msg_ring_pages_pa ) ); 