struct brcmf_cfg80211_info *brcmf_cfg80211_attach(struct brcmf_pub struct device bool p2pdev_forced) struct net_device * ndev = brcmf_get_ifp ( drvr , 0 ) -> ndev ; struct brcmf_cfg80211_info * cfg ; struct wiphy * wiphy ; struct cfg80211_ops * ops ; struct brcmf_cfg80211_vif * vif ; struct brcmf_if * ifp ; if ( ! ndev )  ops = kzalloc ( sizeof ( * ops ) , GFP_KERNEL ); if ( ! ops )  memcpy ( ops , & brcmf_cfg80211_ops , sizeof ( * ops ) ); ifp = netdev_priv ( ndev ); if ( brcmf_feat_is_enabled ( ifp , BRCMF_FEAT_WOWL_GTK ) )  ops -> set_rekey_data = brcmf_cfg80211_set_rekey_data; wiphy = wiphy_new ( ops , sizeof ( struct brcmf_cfg80211_info ) ); if ( ! wiphy )  memcpy ( wiphy -> perm_addr , drvr -> mac , ETH_ALEN ); cfg = wiphy_priv ( wiphy ); cfg -> wiphy = wiphy; cfg -> ops = ops; cfg -> pub = drvr; vif = brcmf_alloc_vif ( cfg , NL80211_IFTYPE_STATION , false ); struct brcmf_cfg80211_vif *brcmf_alloc_vif(struct brcmf_cfg80211_info enum nl80211_iftype bool pm_block) struct brcmf_cfg80211_vif * vif ; vif = kzalloc ( sizeof ( * vif ) , GFP_KERNEL ); if ( ! vif )  vif -> wdev . wiphy = cfg -> wiphy; vif -> wdev . iftype = type; vif -> pm_block = pm_block; brcmf_init_prof ( & vif -> profile ); static void brcmf_init_prof(struct brcmf_cfg80211_profile *prof) memset ( prof , 0 , sizeof ( * prof ) ); 