static gboolean nstrace_seek_read_v30(wtap *wth, gint64 struct wtap_pkthdr *phdr, Buffer *buf, int *err, gchar **err_info) nspr_hd_v20_t hdr ; guint hdrlen ; guint8 * pd ; * err = 0; if ( file_seek ( wth -> random_fh , seek_off , SEEK_SET , err ) == - 1 )  if ( ! wtap_read_bytes ( wth -> random_fh , ( void * ) & hdr , 2 , err , err_info ) )  hdrlen = 2; if ( hdr . phd_RecordSizeLow & NSPR_V20RECORDSIZE_2BYTES )  if ( ! wtap_read_bytes ( wth -> random_fh , ( void * ) & hdr . phd_RecordSizeHigh , 1 , err , err_info ) )  hdrlen = 3; pd = ws_buffer_start_ptr ( buf ); memcpy ( pd , ( void * ) & hdr , hdrlen ); if ( ! wtap_read_bytes ( wth -> random_fh , pd + hdrlen , bytes_to_read , err , err_info ) )  switch ( ( ( nspr_hd_v20_t * ) pd ) -> phd_RecordType )  