static char CVE_2013_4247_PATCHED_build_unc_path_to_root(const struct smb_vol const struct cifs_sb_info *cifs_sb) unsigned int pplen = vol -> prepath ? strlen ( vol -> prepath ) + 1 : 0 ; full_path = kmalloc ( unc_len + pplen + 1 , GFP_KERNEL ); if ( full_path == NULL )  strncpy ( full_path , vol -> UNC , unc_len ); pos = full_path + unc_len; if ( pplen )  * pos = CIFS_DIR_SEP ( cifs_sb ); strncpy ( pos + 1 , vol -> prepath , pplen ); pos += pplen; * pos = '\0'; convert_delimiter ( full_path , CIFS_DIR_SEP ( cifs_sb ) ); cFYI ( 1 , "%s: full_path=%s" , __func__ , full_path ); return full_path ; 