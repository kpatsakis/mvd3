static void tcp_chr_read(void *opaque) CharDriverState * chr = opaque ; TCPCharDriver * s = chr -> opaque ; uint8_t buf [ 1024 ] ; int len , size ; if ( ! s -> connected || s -> max_size <= 0 )  len = sizeof ( buf ); if ( len > s -> max_size )  len = s -> max_size; size = tcp_chr_recv ( chr , ( void * ) buf , len ); static ssize_t tcp_chr_recv(CharDriverState *chr, char *buf, size_t len) TCPCharDriver * s = chr -> opaque ; return recv ( s -> fd , buf , len , 0 ) ; 