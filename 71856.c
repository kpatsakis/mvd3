static brcmf_notify_sched_scan_results(struct brcmf_if const struct brcmf_event_msg *e, void *data) struct brcmf_cfg80211_info * cfg = ifp -> drvr -> config ; struct brcmf_pno_net_info_le * netinfo , * netinfo_start ; struct cfg80211_scan_request * request = NULL ; struct cfg80211_ssid * ssid = NULL ; struct ieee80211_channel * channel = NULL ; struct wiphy * wiphy = cfg_to_wiphy ( cfg ) ; struct brcmf_pno_scanresults_le * pfn_result ; u32 result_count ; if ( e -> datalen < ( sizeof ( * pfn_result ) + sizeof ( * netinfo ) ) )  if ( e -> event_code == BRCMF_E_PFN_NET_LOST )  pfn_result = ( struct brcmf_pno_scanresults_le * ) data; result_count = le32_to_cpu ( pfn_result -> count ); if ( result_count > 0 )  int i ; request = kzalloc ( sizeof ( * request ) , GFP_KERNEL ); ssid = kcalloc ( result_count , sizeof ( * ssid ) , GFP_KERNEL ); channel = kcalloc ( result_count , sizeof ( * channel ) , GFP_KERNEL ); if ( ! request || ! ssid || ! channel )  request -> wiphy = wiphy; data += sizeof ( struct brcmf_pno_scanresults_le ); netinfo_start = ( struct brcmf_pno_net_info_le * ) data; for (i = 0; i < result_count; i++) netinfo = & netinfo_start [ i ]; if ( ! netinfo )  memcpy ( ssid [ i ] . ssid , netinfo -> SSID , netinfo -> SSID_len ); ssid [ i ] . ssid_len = netinfo -> SSID_len; request -> n_ssids ++; channel_req = netinfo -> channel; if ( channel_req <= CH_MAX_2G_CHANNEL )  band = NL80211_BAND_2GHZ; band = NL80211_BAND_5GHZ; channel [ i ] . center_freq = ieee80211_channel_to_frequency ( channel_req , band ); channel [ i ] . band = band; channel [ i ] . flags |= IEEE80211_CHAN_NO_HT40; request -> channels [ i ] = & channel [ i ]; request -> n_channels ++; 