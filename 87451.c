static _cdebbuf *CVE_2007_1217_PATCHED_bufprint(_cdebbuf *cdb, char *fmt,...) va_list f ; size_t n , r ; if ( ! cdb )  r = cdb -> size - cdb -> pos; n = vsnprintf ( cdb -> p , r , fmt , f ); if ( n >= r )  size_t ns = 2 * cdb -> size ; u_char * nb ; while ( ( ns - cdb -> pos ) <= n )  ns *= 2; nb = kmalloc ( ns , GFP_ATOMIC ); if ( ! nb )  memcpy ( nb , cdb -> buf , cdb -> pos ); nb [ cdb -> pos ] = 0; cdb -> buf = nb; cdb -> p = cdb -> buf + cdb -> pos; cdb -> size = ns; r = cdb -> size - cdb -> pos; n = vsnprintf ( cdb -> p , r , fmt , f ); cdb -> p += n; cdb -> pos += n; return cdb ; 