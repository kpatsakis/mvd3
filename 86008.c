static int unix_seqpacket_sendmsg(struct socket *sock, struct msghdr size_t len) int err ; struct sock * sk = sock -> sk ; err = sock_error ( sk ); if ( err )  if ( sk -> sk_state != TCP_ESTABLISHED )  if ( msg -> msg_namelen )  msg -> msg_namelen = 0; return unix_dgram_sendmsg ( sock , msg , len ) ; static int unix_dgram_sendmsg(struct socket *sock, struct msghdr size_t len) int err ; err = scm_send ( sock , msg , & scm , false ); if ( err < 0 )  if ( msg -> msg_flags & MSG_OOB )  if ( msg -> msg_namelen )  err = unix_mkname ( sunaddr , msg -> msg_namelen , & hash ); static int unix_mkname(struct sockaddr_un *sunaddr, int len, unsigned int *hashp) if ( len <= sizeof ( short ) || len > sizeof ( * sunaddr ) )  if ( ! sunaddr || sunaddr -> sun_family != AF_UNIX )  if ( sunaddr -> sun_path [ 0 ] )  ( ( char * ) sunaddr ) [ len ] = 0; len = strlen ( sunaddr -> sun_path ) + 1 + sizeof ( short ); return len ; 