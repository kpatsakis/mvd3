static void goodG2B() wchar_t * password ; password = L "" CWE591_Sensitive_Data_Storage_in_Improperly_Locked_Memory__w32_wchar_t_84_goodG2B * goodG2BObject = new CWE591_Sensitive_Data_Storage_in_Improperly_Locked_Memory__w32_wchar_t_84_goodG2B ( password ) ; CWE591_Sensitive_Data_Storage_in_Improperly_Locked_Memory__w32_wchar_t_84_goodG2B::CWE591_Sensitive_Data_Storage_in_Improperly_Locked_Memory__w32_wchar_t_84_goodG2B(wchar_t * passwordCopy) password = passwordCopy; password = ( wchar_t * ) malloc ( 100 * sizeof ( wchar_t ) ); if ( password == NULL )  printLine ( "Memory could not be allocated" ); exit ( 1 ); if ( ! VirtualLock ( password , 100 * sizeof ( wchar_t ) ) )  printLine ( "Memory could not be locked" ); exit ( 1 ); wcscpy ( password , L "Password1234!" ) delete goodG2BObject CWE591_Sensitive_Data_Storage_in_Improperly_Locked_Memory__w32_wchar_t_84_goodG2B::~CWE591_Sensitive_Data_Storage_in_Improperly_Locked_Memory__w32_wchar_t_84_goodG2B() free ( password ); 