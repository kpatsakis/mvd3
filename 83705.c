static void pgstat_beshutdown_hook(int code,Datum arg) if ( ( bool ) ( MyDatabaseId != ( ( Oid ) 0 ) ) )  pgstat_report_stat ( ( ( bool ) 1 ) ); void pgstat_report_stat(bool force) static const PgStat_TableCounts all_zeroes ; static TimestampTz last_report = 0 ; TimestampTz now ; TabStatusArray * tsa ; int i ; if ( ( pgStatTabList == ( ( void * ) 0 ) || pgStatTabList -> tsa_used == 0 ) && ! have_function_stats && ! force )  now = GetCurrentTransactionStopTimestamp ( ); if ( ! force && ! TimestampDifferenceExceeds ( last_report , now , 500 ) )  for (tsa = pgStatTabList; tsa != ((void *)0); tsa = tsa -> tsa_next) for (i = 0; i < tsa -> tsa_used; i++) PgStat_TableStatus * entry = & tsa -> tsa_entries [ i ] ; if ( memcmp ( ( & entry -> t_counts ) , ( & all_zeroes ) , sizeof ( PgStat_TableCounts ) ) == 0 )  tsa -> tsa_used = 0; 