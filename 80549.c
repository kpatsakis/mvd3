void bad() HANDLE data ; data = INVALID_HANDLE_VALUE; CWE404_Improper_Resource_Shutdown__w32CreateFile_fclose_84_bad * badObject = new CWE404_Improper_Resource_Shutdown__w32CreateFile_fclose_84_bad ( data ) ; CWE404_Improper_Resource_Shutdown__w32CreateFile_fclose_84_bad::CWE404_Improper_Resource_Shutdown__w32CreateFile_fclose_84_bad(HANDLE dataCopy) data = dataCopy; data = CreateFile ( "BadSource_w32CreateFile.txt" , ( GENERIC_WRITE | GENERIC_READ ) , 0 , NULL , OPEN_ALWAYS , FILE_ATTRIBUTE_NORMAL , NULL ); delete badObject CWE404_Improper_Resource_Shutdown__w32CreateFile_fclose_84_bad::~CWE404_Improper_Resource_Shutdown__w32CreateFile_fclose_84_bad() if ( data != INVALID_HANDLE_VALUE )  fclose ( ( FILE * ) data ); 