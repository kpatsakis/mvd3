 CVE_2014_0160_PATCHED_dtls1_process_heartbeat(SSL *s) unsigned char * p = & s -> s3 -> rrec . data [ 0 ] , * pl ; unsigned short hbtype ; unsigned int payload ; unsigned int padding = 16 ; if ( 1 + 2 + 16 > s -> s3 -> rrec . length )  hbtype = * p ++; if ( 1 + 2 + payload + 16 > s -> s3 -> rrec . length )  pl = p; if ( hbtype == TLS1_HB_REQUEST )  unsigned char * buffer , * bp ; unsigned int write_length = 1 + 2 + payload + padding ; if ( write_length > SSL3_RT_MAX_PLAIN_LENGTH )  buffer = OPENSSL_malloc ( write_length ); bp = buffer; * bp ++ = TLS1_HB_RESPONSE; memcpy ( bp , pl , payload ); bp += payload; RAND_pseudo_bytes ( bp , padding ); 