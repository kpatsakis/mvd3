static cupsd_job_t *			/* O - Job object CVE_2015_1158_VULN_add_job(cupsd_client_t  *con,		/* I - Client connection cupsd_printer_t *printer,	/* I - Destination printer mime_type_t     *filetype)	/* I - First print file type, if any */ http_status_t status ; ipp_attribute_t * attr , * auth_info ; const char * mandatory ; int i ; static const char * const readonly [ ] = if ( ! printer -> shared && _cups_strcasecmp ( con -> http -> hostname , "localhost" ) && _cups_strcasecmp ( con -> http -> hostname , ServerName ) )  auth_info = ippFindAttribute ( con -> request , "auth-info" , IPP_TAG_TEXT ); if ( ( status = cupsdCheckPolicy ( printer -> op_policy_ptr , con , NULL ) ) != HTTP_OK )  if ( printer -> num_auth_info_required == 1 && ! strcmp ( printer -> auth_info_required [ 0 ] , "negotiate" ) && ! con -> username [ 0 ] )  if ( auth_info && ! con -> http -> tls && ! httpAddrLocalhost ( con -> http -> hostaddr ) )  if ( ! printer -> accepting )  for (i = 0; i < (int)(sizeof(readonly) / sizeof(readonly[0])); i ++) if ( ( attr = ippFindAttribute ( con -> request , readonly [ i ] , IPP_TAG_ZERO ) ) != NULL )  if ( StrictConformance )  if ( printer -> pc )  for (mandatory = (char  mandatory = (char *)cupsArrayNext(printer->pc->mandatory)) if ( ! ippFindAttribute ( con -> request , mandatory , IPP_TAG_ZERO ) )  if ( filetype && printer -> filetypes && ! cupsArrayFind ( printer -> filetypes , filetype ) )  char mimetype [ MIME_MAX_SUPER + MIME_MAX_TYPE + 2 ] ; snprintf ( mimetype , sizeof ( mimetype ) , "%s/%s" , filetype -> super , filetype -> type ); send_ipp_status ( con , IPP_DOCUMENT_FORMAT , _ ( "Unsupported format \"%s\"." ) , mimetype ); ippAddString ( con -> response , IPP_TAG_UNSUPPORTED_GROUP , IPP_TAG_MIMETYPE , "document-format" , NULL , mimetype ); 