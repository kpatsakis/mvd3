static int CVE_2013_5642_VULN_process_sdp(struct sip_pvt *p, struct sip_request *req, int t38action) struct ast_format_cap * peercapability = ast_format_cap_alloc_nolock ( ) ; struct ast_format_cap * vpeercapability = ast_format_cap_alloc_nolock ( ) ; struct ast_format_cap * tpeercapability = ast_format_cap_alloc_nolock ( ) ; struct ast_format_cap * newjointcapability = ast_format_cap_alloc_nolock ( ) ; struct ast_format_cap * newpeercapability = ast_format_cap_alloc_nolock ( ) ; if ( ! p -> rtp )  if ( ! peercapability || ! vpeercapability || ! tpeercapability || ! newpeercapability || ! newjointcapability )  p -> lastrtprx = p -> lastrtptx = time ( NULL ); memset ( p -> offered_media , 0 , sizeof ( p -> offered_media ) ); 